<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>2024 | Nobuto Murata</title>
    <link>https://nobuto-m.github.io/ja/post/2024/</link>
      <atom:link href="https://nobuto-m.github.io/ja/post/2024/index.xml" rel="self" type="application/rss+xml" />
    <description>2024</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>ja</language><lastBuildDate>Thu, 02 May 2024 12:45:39 +0900</lastBuildDate>
    <image>
      <url>https://nobuto-m.github.io/media/icon_hu1576a685d49928373d27b4c079446fa6_3195_512x512_fill_lanczos_center_3.png</url>
      <title>2024</title>
      <link>https://nobuto-m.github.io/ja/post/2024/</link>
    </image>
    
    <item>
      <title>T14 Gen 3 AMDではSecure Rollback Preventionを無効化してもUEFI BIOSはダウングレードできない</title>
      <link>https://nobuto-m.github.io/ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/</link>
      <pubDate>Thu, 02 May 2024 12:45:39 +0900</pubDate>
      <guid>https://nobuto-m.github.io/ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/</guid>
      <description>

















&lt;figure  id=&#34;figure-uefi-bios上のsecure-rollback-preventionの項目&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;UEFI BIOS上の&amp;#34;Secure Rollback Prevention&amp;#34;の項目&#34; srcset=&#34;
               /ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/featured_hu98a07cb948a4aa5ce68d8a190753e9dc_450211_27deac6b35ebe60c6a247861ded776f7.webp 400w,
               /ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/featured_hu98a07cb948a4aa5ce68d8a190753e9dc_450211_9f6e139530d9a40378a6f26d595994ca.webp 760w,
               /ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/featured_hu98a07cb948a4aa5ce68d8a190753e9dc_450211_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://nobuto-m.github.io/ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/featured_hu98a07cb948a4aa5ce68d8a190753e9dc_450211_27deac6b35ebe60c6a247861ded776f7.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      UEFI BIOS上の&amp;quot;Secure Rollback Prevention&amp;quot;の項目
    &lt;/figcaption&gt;&lt;/figure&gt;

&lt;p&gt;結論として、最近のAMDシステムでは &amp;ldquo;Secure Rollback Prevention&amp;rdquo; (BIOS rollback protection)とは別に &amp;ldquo;AMD Secure &lt;strong&gt;Processor&lt;/strong&gt; Rollback protection&amp;rdquo; があり、これがベンダー側で有効にされている場合は一旦脆弱性対応を含むUEFI BIOSバージョンに上げてしまうとダウングレード（ロールバック）できなくなる。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://fwupd.github.io/libfwupdplugin/hsi.html#org.fwupd.hsi.Amd.RollbackProtection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://fwupd.github.io/libfwupdplugin/hsi.html#org.fwupd.hsi.Amd.RollbackProtection&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This feature prevents an attacker from loading an older firmware onto the part after a security vulnerability has been fixed.&lt;br&gt;
[&amp;hellip;]&lt;br&gt;
End users are not able to directly modify rollback protection, this is controlled by the manufacturer.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://nobuto-m.github.io/ja/post/2024/upgrade-bios-of-thinkpad-t14-gen3-amd-to-r23et73w/&#34;&gt;以前BIOSバージョンを1.49に上げた&lt;/a&gt;ものの、この&lt;code&gt;1.49(R23ET73W)&lt;/code&gt;が&lt;a href=&#34;https://pcsupport.lenovo.com/jp/ja/products/laptops-and-netbooks/thinkpad-t-series-laptops/thinkpad-t14-gen-3-type-21cf-21cg/21cf/21cfcto1ww/downloads/driver-list/component?name=BIOS%2FUEFI&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;公式ページ&lt;/a&gt;から取り下げられてしまっている。何かしらの不具合があったということなので現時点で最新である&lt;code&gt;1.40(R23ET70W)&lt;/code&gt;に戻しておきたかったのと、ファームウェアが原因なんじゃないかと思われる症状に悩まされているので色々なバージョンに戻ってテストしたかったので試行錯誤するはめに。&lt;/p&gt;
&lt;p&gt;まず&lt;code&gt;Secure Rollback Prevention&lt;/code&gt;をオフにしてから、次のように&lt;code&gt;fwupdmgr&lt;/code&gt;でダウングレードを選択するも再起動時に&lt;code&gt;Secure Flash Authentication Failed&lt;/code&gt;で適用されず。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ fwupdmgr downgrade
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;0.	Cancel
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;1.	b0fb0282929536060857f3bd5f80b319233340fd &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Battery&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2.	6fd62cb954242863ea4a184c560eebd729c76101 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Embedded Controller&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;3.	0d5d05911800242bb1f35287012cdcbd9b381148 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Prometheus&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;4.	3743975ad7f64f8d6575a9ae49fb3a8856fe186f &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SKHynix HFS256GDE9X081N&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5.	d77c38c163257a2c2b0c0b921b185f481d9c1e0c &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;System Firmware&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;6.	6df01b2df47b1b08190f1acac54486deb0b4c645 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;TPM&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;7.	362301da643102b9f38477387e2193e57abaa590 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;UEFI dbx&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Choose device &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0-7&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;0.	Cancel
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;1.	0.1.46
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2.	0.1.41
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;3.	0.1.38
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;4.	0.1.36
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5.	0.1.23
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Choose release &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0-5&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;: 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;次に&lt;code&gt;r23uj70wd.iso&lt;/code&gt;をダウンロードしてきて起動するも別のエラーで適用できず。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Error&lt;/p&gt;
&lt;p&gt;The system program file is not correct for this system.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;仕方なくWindowsからも適用を試みるがこれもダメ。このあたりで本当に無理な感じがしてきて、でもなんでダメなのかがよくわからず。そして&lt;code&gt;fwupdmgr&lt;/code&gt;の便利コマンドを知る。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ fwupdmgr security
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host Security ID: HSI:1! &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v1.9.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HSI-1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ BIOS firmware updates:         Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Fused platform:                Locked
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Supported CPU:                 Valid
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ TPM empty PCRs:                Valid
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ TPM v2.0:                      Found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ UEFI bootservice variables:    Locked
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ UEFI platform key:             Valid
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ UEFI secure boot:              Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HSI-2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ SPI write protection:          Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ IOMMU:                         Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Platform debugging:            Locked
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ TPM PCR0 reconstruction:       Valid
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✘ BIOS rollback protection:      Disabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HSI-3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ SPI replay protection:         Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ CET Platform:                  Supported
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Pre-boot DMA protection:       Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Suspend-to-idle:               Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Suspend-to-ram:                Disabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HSI-4
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Processor rollback protection: Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Encrypted RAM:                 Encrypted
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ SMAP:                          Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Runtime Suffix -!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ fwupd plugins:                 Untainted
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Linux kernel lockdown:         Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Linux kernel:                  Untainted
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✘ CET OS Support:                Not supported
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✘ Linux swap:                    Unencrypted
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;This system has HSI runtime issues.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; » https://fwupd.github.io/hsi.html#hsi-runtime-suffix
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host Security Events
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  2024-05-01 15:06:29:  ✘ BIOS rollback protection changed: Enabled → Disabled
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;HSI-2&lt;/code&gt;の中で&lt;code&gt;BIOS rollback protection&lt;/code&gt;は意図通りDisabledになっているものの、&lt;code&gt;HSI-4&lt;/code&gt;セクションの&lt;code&gt;Processor rollback protection&lt;/code&gt;はEnabledになっている。色々見てると、ここがDisabledのまま出荷されて、&lt;code&gt;OS Optimized Defaults&lt;/code&gt;を読み込むとEnabledになるものもあるという記述を見つける。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/fwupd/fwupd/commit/52d6c3cb78ab8ebfd432949995e5d4437569aaa6&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/fwupd/fwupd/commit/52d6c3cb78ab8ebfd432949995e5d4437569aaa6&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Update documentation to indicate that loading &amp;ldquo;OS Optimized Defaults&amp;rdquo;&lt;/p&gt;
&lt;p&gt;may enable security processor rollback protection on Lenovo systems.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;OS Optimized Defaults&lt;/code&gt;をオフにしたらもしかしたら&lt;code&gt;Processor rollback protection&lt;/code&gt;もオフになってくれるかも、と試す。&lt;/p&gt;


















&lt;figure  id=&#34;figure-os-optimized-defaultsをオフにしてみるも変化なし&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;OS Optimized Defaultsをオフにしてみるも変化なし&#34; srcset=&#34;
               /ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/os-optimized-defaults_hu503de795b087b91d9dac387047c8e5d4_262087_6de032c4c45f2693f7d9bd09736c88cd.webp 400w,
               /ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/os-optimized-defaults_hu503de795b087b91d9dac387047c8e5d4_262087_1def10747c2ad883f8826562b7923597.webp 760w,
               /ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/os-optimized-defaults_hu503de795b087b91d9dac387047c8e5d4_262087_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://nobuto-m.github.io/ja/post/2024/no-you-can-t-downgrade-t14-gen-3-amd-s-uefi-bios-even-when-secure-rollback-prevention-is-turned-off/os-optimized-defaults_hu503de795b087b91d9dac387047c8e5d4_262087_6de032c4c45f2693f7d9bd09736c88cd.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      OS Optimized Defaultsをオフにしてみるも変化なし
    &lt;/figcaption&gt;&lt;/figure&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ fwupdmgr security
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host Security ID: HSI:1! &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;v1.9.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✘ BIOS rollback protection:      Disabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HSI-4
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;✔ Processor rollback protection: Enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host Security Events
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  2024-05-02 03:24:45:  ✘ Kernel lockdown disabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  2024-05-02 03:24:45:  ✘ Secure Boot disabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  2024-05-02 03:24:45:  ✘ Pre-boot DMA protection is disabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  2024-05-02 03:24:45:  ✘ Encrypted RAM changed: Encrypted → Not supported
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;いくつかの項目が無効化されるけれども&lt;code&gt;Processor rollback protection&lt;/code&gt;は変わらず、脆弱性対応が含まれていると本当にダウングレードできない。リリースノートにもしっかり書いてあるけど、よくある「ダウングレードはサポートされていないよ」じゃなくて「できないよ」の意味を身を持って理解した。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://download.lenovo.com/pccbbs/mobiles/r23uj73wd.txt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://download.lenovo.com/pccbbs/mobiles/r23uj73wd.txt&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;CHANGES IN THIS RELEASE&lt;/p&gt;
&lt;p&gt;Version 1.49 (UEFI BIOS)
1.32 (ECP)&lt;/p&gt;
&lt;p&gt;[Important updates]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Notice that BIOS can&amp;rsquo;t be downgraded to older BIOS version after upgrade to r23uj73w(1.49).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;[New functions or enhancements]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Enhancement to address security vulnerability, CVE-2023-5058,LEN-123535,LEN-128083,LEN-115697,LEN-123534,LEN-118373,LEN-119523,LEN-123536.&lt;/li&gt;
&lt;li&gt;Change to permit fan rotation after fan error happen.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;より完璧なファームウェアアップデートが来るまでこのまま待ちます。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>SlideShareからSpeaker Deckに移行した</title>
      <link>https://nobuto-m.github.io/ja/post/2024/migration-from-slideshare-to-speakerdeck/</link>
      <pubDate>Sun, 04 Feb 2024 18:26:53 +0900</pubDate>
      <guid>https://nobuto-m.github.io/ja/post/2024/migration-from-slideshare-to-speakerdeck/</guid>
      <description>

















&lt;figure  id=&#34;figure-結局は使わなかったimport-from-slideshareメニュー&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;結局は使わなかった“Import from SlideShare”メニュー&#34;
           src=&#34;https://nobuto-m.github.io/ja/post/2024/migration-from-slideshare-to-speakerdeck/featured.png&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      結局は使わなかった“Import from SlideShare”メニュー
    &lt;/figcaption&gt;&lt;/figure&gt;

&lt;p&gt;今さらも今さらながら。SlideShareを使い出したのは、当時LinkedInが買収して所有してた時期でなんか継続性が期待できそうとかそんな理由だった気がする（&lt;a href=&#34;https://www.linkedin.com/help/linkedin/answer/a518820/scribd-slideshare&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;その後Scribdが買収し現在に至る&lt;/a&gt;）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;移行前: &lt;a href=&#34;https://www.slideshare.net/nobuto_m&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.slideshare.net/nobuto_m&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;移行後: &lt;a href=&#34;https://speakerdeck.com/nobutomurata&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://speakerdeck.com/nobutomurata&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;移行にあたって、&lt;a href=&#34;https://help.speakerdeck.com/help/how-do-i-import-decks-from-slideshare&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SlideShareからのインポートツール(Beta)&lt;/a&gt;があるのは知っていて、書かれているようにサポートチームにメール出したりして有効にしてもらった。ツールに移行したいURLを入力してボタンを押して数週間待ってみたけど特に何も起こらなかったので、結局は手動で元のPDFをアップロードした。Betaだし、ツールが出てからSlideshare側のUIも変わってる気がするしまあそんなもんかと。そもそも数が多くないので全然困らなかった。&lt;/p&gt;
&lt;p&gt;移行してもいいことばかりというわけではなくて、日本語太字部分のレンダリングがおかしかったり、スライドの中のリンクがクリックできない、という既知の問題には引っかかる。&lt;/p&gt;


















&lt;figure  id=&#34;figure-日本語太字部分だけ中に色がつかない&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;日本語太字部分だけ中に色がつかない&#34;
           src=&#34;https://nobuto-m.github.io/ja/post/2024/migration-from-slideshare-to-speakerdeck/ja_font.png&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      日本語太字部分だけ中に色がつかない
    &lt;/figcaption&gt;&lt;/figure&gt;

&lt;p&gt;あとこれを機にSlideShare側でリンクを知っている人のみ公開だったのが2つあったのを全部を公開にした。&lt;a href=&#34;https://speakerdeck.com/nobutomurata/ubuntu-phonetoconvergencezhen-rifan-rihui-2017-05-13&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ubuntu Phoneのやつ&lt;/a&gt;とか懐かしい。&lt;/p&gt;
&lt;p&gt;あんまり関係ないけど、ついでにこのサイトのソーシャルメディアアイコンを&amp;quot;twitter&amp;quot;から&amp;quot;x-twitter&amp;quot;にアップデートした。心の中では&amp;quot;X&amp;quot;ではなくて&amp;quot;X Twitter&amp;quot;と呼び続けます。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>突然LUKS(dm-crypt)起動ドライブの暗号化が解除できなくなった話</title>
      <link>https://nobuto-m.github.io/ja/post/2024/suddenly-luks-dm-crypt-drive-could-not-be-decrypted/</link>
      <pubDate>Thu, 01 Feb 2024 23:35:32 +0900</pubDate>
      <guid>https://nobuto-m.github.io/ja/post/2024/suddenly-luks-dm-crypt-drive-could-not-be-decrypted/</guid>
      <description>

















&lt;figure  id=&#34;figure-絶望の場面&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;絶望の場面&#34; srcset=&#34;
               /ja/post/2024/suddenly-luks-dm-crypt-drive-could-not-be-decrypted/featured_huefb045cac53c25ae4a306e3cbb736c59_183988_1ec817b7f545770f51c33e7c4fc67410.webp 400w,
               /ja/post/2024/suddenly-luks-dm-crypt-drive-could-not-be-decrypted/featured_huefb045cac53c25ae4a306e3cbb736c59_183988_07c0552269bd6291a7efa1da420fa786.webp 760w,
               /ja/post/2024/suddenly-luks-dm-crypt-drive-could-not-be-decrypted/featured_huefb045cac53c25ae4a306e3cbb736c59_183988_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://nobuto-m.github.io/ja/post/2024/suddenly-luks-dm-crypt-drive-could-not-be-decrypted/featured_huefb045cac53c25ae4a306e3cbb736c59_183988_1ec817b7f545770f51c33e7c4fc67410.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      絶望の場面
    &lt;/figcaption&gt;&lt;/figure&gt;

&lt;p&gt;仕事に使ってるメインのマシンでもnobleの開発版を使ってるんですが、月曜日の昼飯前に再起動かけたら暗号化ドライブの解除パスワードを何度入力しても&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;cryptsetup: ERROR: dm_crypt-0: cryptsetup failed, bad password or options?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;と言われてしまってデスクトップまでたどり着けない。何かしらのリグレッションで暗号化ドライブのヘッダが壊れたのではと思い、これは再インストールしてバックアップから切り戻すしかないのではと絶望。簡単にできるようにしてあるとは言え1時間以上はかかるので。&lt;/p&gt;
&lt;p&gt;すぐには諦めきれなかったのでまずはUSBメモリでUbuntuのLive sessionを立ち上げると、暗号化ドライブがあっさりマウントできてしまった。ということはドライブ自体が破損しているわけではないので、パッケージのリグレッションで暗号化が解除できない状況に陥っているのでは、と&lt;code&gt;/var/log/apt/history.log&lt;/code&gt;とにらめっこ。いかんせん開発版なので、前回正常に起動できたときからのアップデートはバイナリパッケージの単位で412個。それなのに、&lt;code&gt;cryptsetup&lt;/code&gt;とかそれっぽいパッケージのアップデートはないし、カーネルを一個前のにしてもダメ。かろうじて&lt;code&gt;libgcrypt20&lt;/code&gt;というinitramfsにも入る、かつcrypt関連のパッケージのアップデートがあったので、これをダウングレードしてみることに。&lt;/p&gt;
&lt;p&gt;USB起動中に、元のマシンのinitramfsの再生成ってどうやるんだっけと調べつつ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo cryptsetup open /dev/nvme0n1p3 dm_crypt-0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo mount /dev/mapper/ubuntu--vg-ubuntu--lv /mnt
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo mount /dev/nvme0n1p2 /mnt/boot
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo mount /dev/nvme0n1p1 /mnt/boot/efi
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; name in proc sys dev run&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    sudo mount --bind /&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt; /mnt/&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo chroot /mnt/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;という感じで&lt;a href=&#34;https://wiki.debian.org/RescueLive&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Debian Wiki&lt;/a&gt;を見ながらchrootした。ここでの鍵はopenするときに&lt;code&gt;dm_crypt-0&lt;/code&gt;という名前でなければ後々不都合があり、なぜならそれは&lt;code&gt;/etc/crypttab&lt;/code&gt;に&lt;code&gt;dm_crypt-0&lt;/code&gt;と書かれているから。ただ、&lt;code&gt;crypttab&lt;/code&gt;はopenした後にしか読めないので名前を覚えてなくて何回かやり直した。&lt;/p&gt;
&lt;p&gt;ここまでくればパッケージのダウンロードやダウングレードも簡単で、initramfsの再生成も&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo update-initramfs -u -k all
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;とするだけ。&lt;/p&gt;
&lt;p&gt;でも再起動しても問題は解決していない。。。&lt;code&gt;libgcrypt20&lt;/code&gt;が違うんだったら412個全部のパッケージをダウングレードして切り分けするのもしんどいので諦めようかと思ったそのとき、ネット上でリカバリーモード（シングルユーザーモード）なら解除できる時あるよっていう情報を見かけて、そんなはずはないでしょと思ってリカバリーモードで起動したら解除できた！crypt関連のモジュール関係ないじゃん！Plymouthじゃん！そこは考えてなかったよ！&lt;/p&gt;
&lt;p&gt;ということで&lt;code&gt;/etc/default/grub&lt;/code&gt;から&lt;code&gt;splash&lt;/code&gt;を除いてPlymouthなしで起動するようにして応急処置完了。&lt;/p&gt;
&lt;p&gt;ただ、重要そうな問題のような気がしたので再現環境を作りたかったけど、シンプルなパスワードを設定すると100%解除に成功してしまって再現できない。何がトリガーなのかよくわからないまま、PlymouthをダウングレードしてPlymouthのリグレッションであることを確認したりしていた。&lt;/p&gt;
&lt;p&gt;ふと、Yubikeyがコンマ何秒の間に30文字以上を一気にタイプするからではと思い、Yubikeyを再フォーマットしてクリーンな状態でやったら無事再現できた。ただここで自分のYubikeyの使い方に関して補足しておくと、LUKSのパスフレーズ打つときにYubikeyから出力される文字列だけで解除しているわけではなくて（それだとYubikeyとノートPCを強奪されたらだれでも解除できちゃうので）、自分でパスフレーズを手打ちしてそれを打ち終わったらYubikeyのボタンをタッチして続けて打ち込む、という一つのパスフレーズボックスでなんちゃって二要素認証っぽいことにしている。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;自分で打った文字列 + Yubikeyから出力される文字列(30文字以上) + &amp;lt;ENTER&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;もうちょっとちゃんとやるなら毎回同じ文字列をYubikeyから出すんじゃなくて、Challenge-response形式にする&lt;a href=&#34;https://launchpad.net/ubuntu/&amp;#43;source/yubikey-luks&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;yubikey-luks&lt;/a&gt;とかを使うのもあるけど今のところは固定文字列で落ち着いてる。&lt;/p&gt;
&lt;p&gt;とにかく再現手順がはっきりしたのでupstreamへ。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;ldquo;Typing passphrase pretty quickly using Yubikey fails to unlock a LUKS partition&amp;rdquo;&lt;/strong&gt;&lt;br&gt;
&lt;a href=&#34;https://gitlab.freedesktop.org/plymouth/plymouth/-/issues/243&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://gitlab.freedesktop.org/plymouth/plymouth/-/issues/243&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;そこでありがたいことに&lt;a href=&#34;https://gitlab.freedesktop.org/plymouth/plymouth/-/commit/6e411c7dcb77b69d7d4e897f6a5676f8bfb1c516&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;このコミット&lt;/a&gt;で直った問題じゃない？って教えてくれて、&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;That leads to keystrokes getting eaten.&lt;/p&gt;
&lt;p&gt;This commit makes the terminal more careful about setting the
keyboard mode. It now only changes it when plymouth thinks its
necessary to do so.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;コミットメッセージ見てもキーストロークがどっかいっちゃうってのは納得。&lt;/p&gt;
&lt;p&gt;カーネルパラメーターに&lt;code&gt;plymouth.debug&lt;/code&gt;つけて&lt;code&gt;/var/log/plymouth-debug.log&lt;/code&gt;を提供したら色々フィードバックをくれて、今のところの理解だと、&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;splash&lt;/code&gt;をつけなければPlymouthがそもそも使われないので回避される&lt;/li&gt;
&lt;li&gt;&lt;code&gt;23.360.11&lt;/code&gt;じゃなくて&lt;code&gt;24.004.60&lt;/code&gt;なら今回の問題（リグレッション）が修正されているので問題なくなる&lt;/li&gt;
&lt;li&gt;UbuntuとかDebianがまだinitramfsに入れてない&lt;code&gt;/usr/share/X11/xkb&lt;/code&gt;を入れるようにすれば、今までのvt consoleじゃなくてxkb consoleを使うようになるからそれでも回避される&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ちなみにdownstreamレポートはここ。&lt;br&gt;
&lt;a href=&#34;https://bugs.launchpad.net/ubuntu/&amp;#43;source/plymouth/&amp;#43;bug/2051478&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://bugs.launchpad.net/ubuntu/+source/plymouth/+bug/2051478&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;それにしてもPlymouth高機能になりすぎててすごい。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ThinkPad T14 Gen 3 AMDのBIOSを1.49/1.32(R23ET73W)に上げる</title>
      <link>https://nobuto-m.github.io/ja/post/2024/upgrade-bios-of-thinkpad-t14-gen3-amd-to-r23et73w/</link>
      <pubDate>Sat, 13 Jan 2024 17:27:09 +0900</pubDate>
      <guid>https://nobuto-m.github.io/ja/post/2024/upgrade-bios-of-thinkpad-t14-gen3-amd-to-r23et73w/</guid>
      <description>&lt;p&gt;何度かやったことはあるけど、やる度に&lt;code&gt;geteltorito&lt;/code&gt;というコマンド名を思い出せないのでそのためのメモ。&lt;/p&gt;
&lt;p&gt;ThinkPad T14 Gen 3 AMD (21CFCTO1WW)に&lt;a href=&#34;https://pcsupport.lenovo.com/jp/ja/products/laptops-and-netbooks/thinkpad-t-series-laptops/thinkpad-t14-gen-3-type-21cf-21cg/downloads/ds557681-bios-update-utility-bootable-cd-for-windows-10-64-bit-thinkpad-t14-gen-3-type-21cf-21cg-t16-gen-1-type-21ch-21cj-p16s-gen-1type-21ck-21cl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BIOS/UEFIアップデートR23ET73W(1.49)&lt;/a&gt;が来ていたけども、fwupdでは上手く当たらなかった。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ fwupdmgr update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;firmware signature missing or not trusted&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;OnlyTrusted&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt; in
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;/etc/fwupd/daemon.conf ONLY &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; you are a firmware developer
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;いろいろなところで報告されていて、しばらくしたら解決済みステータスになった。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://forums.lenovo.com/t5/Ubuntu/Ubuntu-23-10-21CH004XGE-upgrade-to-r23ul73w-1-49-firmware-signature-missing-or-not-trusted/m-p/5281458&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://forums.lenovo.com/t5/Ubuntu/Ubuntu-23-10-21CH004XGE-upgrade-to-r23ul73w-1-49-firmware-signature-missing-or-not-trusted/m-p/5281458&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/fwupd/fwupd/issues/6646&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/fwupd/fwupd/issues/6646&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/fwupd/fwupd/issues/6647&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/fwupd/fwupd/issues/6647&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ただ現時点では該当のアップデートはまた消されていて入手不可になっているので、もう少し必要な作業があるみたい。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://fwupd.org/lvfs/devices/com.lenovo.ThinkPadR23ET.firmware&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://fwupd.org/lvfs/devices/com.lenovo.ThinkPadR23ET.firmware&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;この狭間のタイミングでアップデートしようとしてるうちに、「アップデートの適用に失敗」のステータスだけれども、起動後には&lt;code&gt;1.46&lt;/code&gt;ではなく&lt;code&gt;1.49&lt;/code&gt;が動いているという気持ち悪い状態になってしまった。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ fwupdmgr get-history
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;LENOVO 21CFCTO1WW
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;│
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;└─System Firmware:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │   Device ID:          d96de5c124b60ed6241ebcb6bb2c839cb5580786
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │   Previous version:   0.1.46
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │   Update State:       Failed
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │   Update Error:       failed to run update on reboot
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │   Last modified:      2024-01-10 01:07
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │   GUID:               e40809b1-7d9f-4dc4-7c0f-8ace63b43687
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │   Device Flags:       • Internal device
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │                       • Updatable
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │                       • System requires external power &lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │                       • Needs a reboot after installation
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │                       • Reported to remote server
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │                       • Cryptographic &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; verification is available
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │                       • Device is usable &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the duration of the update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  │
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  └─&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;null&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; Update:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        New version:      0.1.49
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        License:          Unknown
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Description:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        The vendor did not supply any release notes.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;なので念のためLenovoの「BIOS アップデートユーティリティ (起動CD用)」の&lt;code&gt;r23uj73wd.iso&lt;/code&gt;を使って、再度アップデートを適用した。&lt;/p&gt;
&lt;p&gt;手順としては、&lt;code&gt;genisoimage&lt;/code&gt;パッケージにある&lt;code&gt;geteltorito&lt;/code&gt;コマンドを使って、CDイメージから最初に見つかったブートイメージを抽出。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ isoinfo -i r23uj73wd.iso -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;CD-ROM is in ISO &lt;span class=&#34;m&#34;&gt;9660&lt;/span&gt; format
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;System id:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Volume id: R23UJ73WD
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Volume &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; id:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Publisher id:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Data preparer id:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Application id: NERO BURNING ROM VER 12,5,5,0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Copyright File id:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Abstract File id:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Bibliographic File id:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Volume &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; size is: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Volume &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; sequence number is: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Logical block size is: &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Volume size is: &lt;span class=&#34;m&#34;&gt;23734&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;El Torito VD version &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; found, boot catalog is in sector &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Joliet with UCS level &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NO Rock Ridge present
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Eltorito validation header:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Hid &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Arch &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x86&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ID &lt;span class=&#34;s1&#34;&gt;&amp;#39;NERO BURNING ROM VER 12&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Key &lt;span class=&#34;m&#34;&gt;55&lt;/span&gt; AA
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Eltorito defaultboot header:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Bootid &lt;span class=&#34;m&#34;&gt;88&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bootable&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Boot media &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Hard Disk Emulation&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Load segment 7C0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Sys &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Nsect &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Bootoff 1B &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ geteltorito -o r23uj73wd.img r23uj73wd.iso
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Booting catalog starts at sector: &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Manufacturer of CD: NERO BURNING ROM VER &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Image architecture: x86
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Boot media &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; is: harddisk
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;El Torito image starts at sector &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt; and has &lt;span class=&#34;m&#34;&gt;94208&lt;/span&gt; sector&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; of &lt;span class=&#34;m&#34;&gt;512&lt;/span&gt; Bytes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Image has been written to file &lt;span class=&#34;s2&#34;&gt;&amp;#34;r23uj73wd.img&amp;#34;&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;このディスクイメージをUSBメモリなどにコピーして起動する。セキュアブートには対応していないので、適用時は一時的に無効化しておく。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ file r23uj73wd.img
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;r23uj73wd.img: DOS/MBR boot sector; partition 1 : ID=0xb, active, start-CHS (0x0,1,1), end-CHS (0x2d,63,32), startsector 32, 94176 sectors
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo dd &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;r23uj73wd.img &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/dev/disk/by-id/usb-PATH-TO-USB-DRIVE-0&lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;bs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4M &lt;span class=&#34;nv&#34;&gt;oflag&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;direct,sync &lt;span class=&#34;nv&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;progress
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;難しいのはコマンド名を思い出すことだけ。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>表示されないFlutter版ubuntu-desktop-installerをgit版で無理やり動かす</title>
      <link>https://nobuto-m.github.io/ja/post/2024/forcibly-run-ubuntu-desktop-installer-git/</link>
      <pubDate>Tue, 09 Jan 2024 00:25:18 +0900</pubDate>
      <guid>https://nobuto-m.github.io/ja/post/2024/forcibly-run-ubuntu-desktop-installer-git/</guid>
      <description>&lt;p&gt;Ubuntu開発版のインストールイメージのスナップショットが置いてある&lt;a href=&#34;https://cdimages.ubuntu.com/daily-live/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&amp;ldquo;daily-live&amp;rdquo;&lt;/a&gt;を使う人はほぼいないと思うけど（正式版でもないし）、昨年末ぐらいからまた画面が真っ白になっちゃう問題が発生しているみたい。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://bugs.launchpad.net/ubuntu-desktop-installer/&amp;#43;bug/2043915&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://bugs.launchpad.net/ubuntu-desktop-installer/+bug/2043915&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/canonical/ubuntu-desktop-installer/issues/2391&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/canonical/ubuntu-desktop-installer/issues/2391&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/canonical/ubuntu-desktop-installer/issues/2407&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/canonical/ubuntu-desktop-installer/issues/2407&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


















&lt;figure  id=&#34;figure-インストーラーを起動しても画面が真っ白&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;インストーラーを起動しても画面が真っ白&#34;
           src=&#34;https://nobuto-m.github.io/ja/post/2024/forcibly-run-ubuntu-desktop-installer-git/featured.png&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      インストーラーを起動しても画面が真っ白
    &lt;/figcaption&gt;&lt;/figure&gt;

&lt;p&gt;エラーとしてはLibGLまわりで、snap化されてるFlutterアプリケーションで起こっているみたい。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ ubuntu-desktop-installer
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ubuntu_desktop_installer:10370&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: Gtk-WARNING **: 07:10:37.648: /usr/lib/x86_64-linux-gnu/gtk-3.0/3.0.0/immodules/im-ibus.so: undefined symbol: ibus_input_context_set_post_process_key_event
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ubuntu_desktop_installer:10370&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: Gtk-WARNING **: 07:10:37.648: Loading IM context &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ibus&amp;#39;&lt;/span&gt; failed
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;libGL error: No matching fbConfigs or visuals found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;libGL error: failed to load driver: radeonsi
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;libGL error: No matching fbConfigs or visuals found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;libGL error: failed to load driver: radeonsi
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;libGL error: No matching fbConfigs or visuals found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;libGL error: failed to load driver: swrast
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;** &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ubuntu_desktop_installer:10370&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: WARNING **: 07:10:37.791: Failed to start Flutter renderer: Unable to create a GL context
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;** &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ubuntu_desktop_installer:10370&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: WARNING **: 07:10:40.793: Unable to retrieve framework response: No engine to send to
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;これといった回避策はなくて、23.10をインストールしてから&lt;code&gt;do-release-upgrade -d&lt;/code&gt;すればインストール直後だしすぐにnoble開発版に追いつけるんだけどまあちょっと無理やり動かしてみたメモ。たぶん今後一切使うことがないと思う。&lt;/p&gt;
&lt;h2 id=&#34;インストーラーを一旦終了する&#34;&gt;インストーラーを一旦終了する&lt;/h2&gt;
&lt;p&gt;Liveセッションを立ち上げると、画面の真ん中に真っ白なウィンドウが出てきて何もできないので、まずはこのインストーラーを終了する。ウィンドウが閉じられればよくて、&lt;code&gt;Alt + F4&lt;/code&gt;とか、&lt;code&gt;Alt + Space&lt;/code&gt;でメニューを出して&lt;code&gt;Close&lt;/code&gt;を押すとかそんな感じ。&lt;/p&gt;
&lt;h2 id=&#34;flutterのインストール&#34;&gt;Flutterのインストール&lt;/h2&gt;
&lt;p&gt;次にFlutterのインストール。Snap版とそうじゃない2パターンがドキュメントにあって今回はSnap版じゃない方を使う。CIでもSnap版使ってなさそうですし。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/.github/workflows/installer.yaml#L31-L35&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/.github/workflows/installer.yaml#L31-L35&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Install Flutter&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;uses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;subosito/flutter-action@v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;with&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;channel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;stable&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;flutter-version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;${{env.FLUTTER_VERSION}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;p&gt;ちなみにインストールするバージョンは最新では自分で色々と変更する必要がありそうで、インストーラーが想定している&lt;code&gt;3.10.6&lt;/code&gt;を明示的に使う。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/snap/snapcraft.yaml#L130-L132&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/snap/snapcraft.yaml#L130-L132&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;flutter-git&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;https://github.com/flutter/flutter.git&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;source-tag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3.10.6&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;p&gt;インストール手順としてはFlutterの公式ドキュメントの&lt;code&gt;Method 2: Manual installation&lt;/code&gt;を少し変えて&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.flutter.dev/get-started/install/linux#method-2-manual-installation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.flutter.dev/get-started/install/linux#method-2-manual-installation&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo apt update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo apt install git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wget https://storage.googleapis.com/flutter_infra_release/releases/stable/linux/flutter_linux_3.10.6-stable.tar.xz
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tar xf flutter_linux_3.10.6-stable.tar.xz
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$PATH&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:`pwd`/flutter/bin&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;とした後に、&lt;code&gt;flutter doctor&lt;/code&gt;でインストール自体ができてるかの確認。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ flutter doctor
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;┌─────────────────────────────────────────────────────────┐
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;│ A new version of Flutter is available!                  │
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;│                                                         │
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;│ To update to the latest version, run &lt;span class=&#34;s2&#34;&gt;&amp;#34;flutter upgrade&amp;#34;&lt;/span&gt;. │
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;└─────────────────────────────────────────────────────────┘
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Doctor summary &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;to see all details, run flutter doctor -v&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✓&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Flutter &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Channel stable, 3.10.6, on Ubuntu Noble Numbat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;development branch&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 6.5.0-9-generic, locale C.UTF-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✗&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Android toolchain - develop &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Android devices
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ✗ Unable to locate Android SDK.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      Install Android Studio from: https://developer.android.com/studio/index.html
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      On first launch it will assist you in installing the Android SDK components.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;or visit https://flutter.dev/docs/get-started/install/linux#android-setup &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; detailed instructions&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      If the Android SDK has been installed to a custom location, please use
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;flutter config --android-sdk&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; to update to that location.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✗&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Chrome - develop &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the web &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Cannot find Chrome executable at google-chrome&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ! Cannot find Chrome. Try setting CHROME_EXECUTABLE to a Chrome executable.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✗&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Linux toolchain - develop &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Linux desktop
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ✗ clang++ is required &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Linux development.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      It is likely available from your distribution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;e.g.: apt install clang&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, or can be downloaded from https://releases.llvm.org/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ✗ CMake is required &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Linux development.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      It is likely available from your distribution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;e.g.: apt install cmake&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, or can be downloaded from https://cmake.org/download/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ✗ ninja is required &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Linux development.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      It is likely available from your distribution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;e.g.: apt install ninja-build&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, or can be downloaded from https://github.com/ninja-build/ninja/releases
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ✗ pkg-config is required &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Linux development.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      It is likely available from your distribution &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;e.g.: apt install pkg-config&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, or can be downloaded from https://www.freedesktop.org/wiki/Software/pkg-config/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Android Studio &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;not installed&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✓&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connected device &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; available&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✓&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Network resources
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;! Doctor found issues in &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; categories.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;Linux toolchain&lt;/code&gt;のところで足りないものがあるよと言われるので、これもまた公式ドキュメントの&lt;code&gt;Linux prerequisites&lt;/code&gt;の通り&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.flutter.dev/get-started/install/linux#linux-prerequisites&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.flutter.dev/get-started/install/linux#linux-prerequisites&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo apt-get install clang cmake git ninja-build pkg-config libgtk-3-dev liblzma-dev libstdc++-12-dev
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;p&gt;とすれば、&lt;code&gt;flutter doctor&lt;/code&gt;でインストール自体と&lt;code&gt;Linux toolchain&lt;/code&gt;のところのチェックが通るようになる。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ flutter doctor
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Doctor summary &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;to see all details, run flutter doctor -v&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✓&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Flutter &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Channel stable, 3.10.6, on Ubuntu Noble Numbat &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;development branch&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; 6.5.0-9-generic, locale C.UTF-8&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✗&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Android toolchain - develop &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Android devices
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ✗ Unable to locate Android SDK.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      Install Android Studio from: https://developer.android.com/studio/index.html
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      On first launch it will assist you in installing the Android SDK components.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;or visit https://flutter.dev/docs/get-started/install/linux#android-setup &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; detailed instructions&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      If the Android SDK has been installed to a custom location, please use
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;flutter config --android-sdk&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; to update to that location.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✗&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Chrome - develop &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the web &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Cannot find Chrome executable at google-chrome&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    ! Cannot find Chrome. Try setting CHROME_EXECUTABLE to a Chrome executable.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✓&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Linux toolchain - develop &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Linux desktop
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Android Studio &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;not installed&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✓&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Connected device &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; available&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;✓&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Network resources
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;! Doctor found issues in &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; categories.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;git版ubuntu-desktop-installerの実行&#34;&gt;Git版ubuntu-desktop-installerの実行&lt;/h2&gt;
&lt;p&gt;Flutterがインストールできたので、今度はubuntu-desktop-installerの実行。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/README.md#build-and-dry-run-the-installer&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/README.md#build-and-dry-run-the-installer&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Githubから引っ張ってくるところはそのままでよくて、&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/canonical/ubuntu-desktop-installer.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ubuntu-desktop-installer
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git submodule update --init --recursive
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;依存するものをインストールして&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make install_deps
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;で、実際のディレクトリに移動して実行するところで、このまま実行するとドキュメントに書いてある通り&lt;code&gt;Dry-run&lt;/code&gt;モードになるので実機にはUbuntuをインストールできない（テスト用の仮想ドライブが使われる）。&lt;/p&gt;
&lt;p&gt;Dry-runをやめるには&lt;code&gt;LIVE_RUN=1&lt;/code&gt;が肝で、&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/snap/snapcraft.yaml#L34&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/canonical/ubuntu-desktop-installer/blob/4edfab2b3cd4fb18ab95c79ffa16040fa57449b9/snap/snapcraft.yaml#L34&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;LIVE_RUN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;p&gt;これを渡してあげるとGit版から実機インストールできる。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; packages/ubuntu_desktop_installer
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;env &lt;span class=&#34;nv&#34;&gt;LIVE_RUN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; flutter run
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;まとめ&#34;&gt;まとめ&lt;/h2&gt;
&lt;p&gt;どっからどう読んでも無理やりなので、正式なインストールイメージを使うか、どうしても&lt;code&gt;daily-live&lt;/code&gt;がいいっていう場合は待つのが正解。&lt;/p&gt;
&lt;p&gt;ちなみに、&lt;code&gt;ubuntu-desktop-installer&lt;/code&gt; snapは消してしまってはダメで、&lt;code&gt;flutter run&lt;/code&gt;するだけだとDry-runモード用の&lt;code&gt;subiquity-server&lt;/code&gt;が立ち上がって、もちろん実機を想定してない。実機インストールの場合はサーバープロセスはもちろん高い権限が必要なので、最初から入ってるSnap版から&lt;code&gt;snap.ubuntu-desktop-installer.subiquity-server.service&lt;/code&gt;を使った。問題があったのはフロントエンドの表示部分だけなので。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
